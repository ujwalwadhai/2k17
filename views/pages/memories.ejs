<!DOCTYPE html>
<html data-theme="<%= theme || 'purple' %>" lang="en">

<head>
  <%- include('../partials/head') %>
  <title>Memories • 2k17 Platform</title>
  <link rel="preconnect" href="https://res.cloudinary.com" />
  <link rel="stylesheet" href="/styles/css/memories.css">
  <link rel="stylesheet" href="/styles/css/viewFile.css">
</head>

<body>
  <%- include('../partials/loader') %>
  <%- include('../partials/navbar') %>
  <br><br>
  <section class="memories-container">
    <h1>Batch Memories</h1>

    <div id="drive">
      <div class="breadcrumb">
        <a onclick="loadFolder('root')"><span class="fal fa-house"></span></a>

      </div>

      <div class="folders">

      </div>
      <div class="gallery">

      </div>
    </div>
  </section>

  <%- include('../partials/footer') %>

  <div id="view-image-popup" class="view-file-popup">
    <div class="overlay" onclick="closeViewImage()"></div>
    <div class="view-file-box">
      <header class="view-file-header">
        <div class="file-info">
          <i class="fal fa-image"></i>
          <span class="file-name" id="imgName"></span>
        </div>
        <div class="action-buttons">
          <button class="action-btn" id="share-icon"><i class="fal fa-share"></i></button>
          <button class="action-btn" data-action="comment" id="comments-icon" aria-label="Comments"><i class="fal fa-message-lines"></i></button>
          <button class="action-btn close-icon" onclick="closeViewImage()" aria-label="Close"><i class="fal fa-times"></i></button>
        </div>
      </header>
      <div class="view-image-large" id="view-image-large">
        <img src="" oncontextmenu="return false;" alt="Image" id="imgLarge">
        <button class="action-btn tag-memory" id="tagBtnImg" aria-label="Tag Memory">I'm in this memory</button>
      </div>
    </div>
  </div>

  <div id="view-video-popup" class="view-file-popup">
    <div class="overlay" onclick="closeViewVideo()"></div>
    <div class="view-file-box">
      <div class="heading">
        <p class="title"><span class="fal fa-video"></span> <span id="videoName"></span></p>
        <div class="right-btns">
          <p id="share-icon" class="comments-icon fal fa-share"></p>
          <p id="comments-icon" class="comments-icon fal fa-message"></p>
          <p class="close-icon fal fa-xmark" onclick="closeViewVideo()"></p>
        </div>
      </div>
      <div class="view-video-large" id="view-video-large">
        <div class="iframe-wrapper">
          <iframe id="videoIframe" frameborder="0" width="650" height="900"></iframe>
          <div class="overlay-text">2k17 Platform ❤️</div>
        </div>
      </div>
    </div>
  </div>

  <div id="comments-popup">
    <div class="overlay" onclick="closeComments()" id="overlay"></div>
    <div class="comments-box">
      <div class="heading">
        <p>Comments</p>
        <p class="close-icon fas fa-times" onclick="closeComments()"></p>
      </div>
      <div class="comments-list" id="comments-list">
      </div>
      <div class="input-area">
        <input id="new-comment" autocomplete="off" placeholder="Write a comment..." />
        <button type="button" id="newCommentBtn">Post</button>
      </div>
    </div>
  </div>

  <script>
    const USER_ID = '<%- user ? user._id : null %>'
  </script>
  <script src="/js/memories.js"></script>
  <script>
    const currentFolder = <%- JSON.stringify(currentFolder || null) %>;
    document.addEventListener('DOMContentLoaded', () => {
      if (currentFolder && currentFolder.name === "My Memories") {
        loadFolder("my-memories");
      } else if (currentFolder && currentFolder._id) {
        loadFolder(currentFolder._id);
      } else {
        loadFolder('root', false)
      }
    });
  </script>

</body>

</html>