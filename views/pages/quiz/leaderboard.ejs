<!DOCTYPE html>
<html lang="en" data-theme="<%= theme ?? 'purple' %>" data-font="<%= font ?? 'Lato' %>">
<head>
    <%- include('../../partials/head') %>
    <link rel="stylesheet" href="/styles/css/quiz/leaderboard.css">
    <title><%= title %> â€¢ 2k17 Platform</title>
</head>
<body>
    <%- include('../../partials/navbar') %>
    <%- include('../../partials/loader') %>
    <br><br><br><br> 

    <div class="leaderboard-container loader-after-body" style="display: none;">
        <h1>Leaderboard</h1>
        <h2><%= quiz.title %></h2>
        <div class="btns">
            <% if(attempted) { %>
                <button onclick="window.location.href = '/quiz/<%= quiz._id %>'"><span class="fal fa-chart-mixed"></span> &nbsp; View your attempt</button>
            <% } else if(!quiz.isClosed) { %>
                <button onclick="window.location.href = '/quiz/<%= quiz._id %>'"><span class="fal fa-play"></span>&nbsp; Start Quiz</button>
            <% } %>
            <% if(quiz.isClosed){ %>
            <p class="grey-1">This quiz is now closed</p>
            <% } %>
        </div>

        <% if (leaderboard && leaderboard.length > 0) { %>
            <table class="leaderboard-table">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Username</th>
                        <th>Score</th>
                    </tr>
                </thead>
                <tbody>
                    <% leaderboard.forEach((entry, index) => { %>
                        <tr>
                            <td><%- index == 0 ? '<span class="fal fa-user-crown"></span>' : index + 1 %></td>
                            <td onclick="window.location.href = '/<%= entry.user ? entry.user.username : '' %>'"><%= entry.user ? entry.user.username : 'Unknown' %></td>
                            <td><%= entry.score %></td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        <% } else { %>
            <p style="text-align: center; margin-top: 2rem;">
                No one has completed this quiz yet. 
                <a href="/quiz/<%= quiz._id %>">Be the first!</a>
            </p>
        <% } %>
    </div>
</body>
</html>