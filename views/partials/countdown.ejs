<div id="countdown-box">
    <p id="text1">We are launching soon ...</p>
    <h1 id="countdown">Loading...</h1>
    <p id="text2"><a href="/pre-register">Pre-register now </a> to get a verified 2k17 account and an email when we
        launch.</p>
</div>
<script>
    const colors = ['#7b5cf0', '#6342d8', '#ff4081', '#00e5ff', '#ffd740'];

    function setupCanvas(id) {
        const canvas = document.createElement('canvas');
        canvas.style.position = 'fixed';
        canvas.style.top = '0';
        canvas.style.left = '0';
        canvas.style.width = '100vw';
        canvas.style.height = '100vh';
        canvas.style.pointerEvents = 'none';
        canvas.style.zIndex = '9999';
        canvas.id = id;
        document.body.appendChild(canvas);
        const ctx = canvas.getContext('2d');

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        window.addEventListener('resize', resize);
        resize();

        return { canvas, ctx };
    }

    function renderConfetti() {
        const { canvas, ctx } = setupCanvas('canvas-wrapping');
        const timeDelta = 0.05;
        const xAmplitude = 0.5;
        const yAmplitude = 1;
        const xVelocity = 2;
        if(window.innerWidth < 600) {
            var yVelocity = 0.7;
        } else {
            var yVelocity = 3;
        }

        let time = 0;
        const confetti = [];

        for (let i = 0; i < 100; i++) {
            const radius = Math.random() * 5 + 2.5;
            const tilt = Math.floor(Math.random() * 10) - 5;
            const xSpeed = Math.random() * xVelocity - xVelocity / 2;
            const ySpeed = Math.random() * yVelocity;
            const x = Math.random() * canvas.width;
            const y = Math.random() * canvas.height - canvas.height;

            confetti.push({
                x,
                y,
                xSpeed,
                ySpeed,
                radius,
                tilt,
                color: colors[Math.floor(Math.random() * colors.length)],
                phaseOffset: i,
            });
        }

        let animationId;

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confetti.forEach((piece) => {
                piece.y += (Math.cos(piece.phaseOffset + time) + 1) * yAmplitude + piece.ySpeed;
                piece.x += Math.sin(piece.phaseOffset + time) * xAmplitude + piece.xSpeed;

                if (piece.x < 0) piece.x = canvas.width;
                if (piece.x > canvas.width) piece.x = 0;
                if (piece.y > canvas.height) piece.y = 0;

                ctx.beginPath();
                ctx.lineWidth = piece.radius;
                ctx.strokeStyle = piece.color;
                ctx.moveTo(piece.x + piece.tilt, piece.y);
                ctx.lineTo(piece.x + piece.tilt / 2, piece.y + piece.tilt + piece.radius);
                ctx.stroke();
            });

            time += timeDelta;
            animationId = requestAnimationFrame(update);
        }

        update();
    }


    const target = new Date("2025-07-01T18:30:00Z");

    function pad(n) {
        return n < 10 ? '0' + n : n;
    }

    function updateCountdown() {
        const now = new Date();
        let diff = target - now;

        if (diff <= 0) {
            renderConfetti()
            document.getElementById('countdown').innerHTML =
                `<span class="digit-d">00<span class="unit">d</span></span> ` +
                `<span class="digit-h">00<span class="unit">h</span></span> ` +
                `<span class="digit-m">00<span class="unit">m</span></span> ` +
                `<span class="digit-s">00<span class="unit">s</span></span>`;
            document.querySelector('#text1').textContent = '2k17 Platform is live! üöÄ';
            document.querySelector('#text2').textContent = 'Login with your account to access this marvelous platform. ‚úåÔ∏è';
            document.querySelector('.cta-btn').innerHTML = 'Login now &nbsp; &nbsp; <span class="fal fa-arrow-right"></span>'
            document.querySelector('.cta-btn').href = '/login'
            document.querySelector('#navbar-login-btn-small').textContent = 'Login'
            document.querySelector('#navbar-login-btn-small').href = '/login'
            document.querySelector('#navbar-login-btn-large').textContent = 'Login'
            document.querySelector('#navbar-login-btn-large').href = '/login'
            document.querySelectorAll('nav ul li a').forEach((el) => {
                el.style.color = 'white'
            })
            clearInterval(interval);
            return;
        } else {

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const minutes = Math.floor((diff / (1000 * 60)) % 60);
            const seconds = Math.floor((diff / 1000) % 60);

            document.getElementById('countdown').innerHTML =
                `<span class="digit-d">${pad(days)}<span class="unit">d</span></span> ` +
                `<span class="digit-h">${pad(hours)}<span class="unit">h</span></span> ` +
                `<span class="digit-m">${pad(minutes)}<span class="unit">m</span></span> ` +
                `<span class="digit-s">${pad(seconds)}<span class="unit">s</span></span>`;
            document.querySelector('.header').querySelectorAll('a').forEach((el) => {
                el.style.color = '#888'
            })
            document.querySelectorAll('.cta-btn').forEach(btn => btn.style.color = 'white')
            document.querySelectorAll('.login-btn').forEach(btn => btn.style.color = 'white')
        }
    }

    const interval = setInterval(updateCountdown, 1000);
    updateCountdown();
</script>